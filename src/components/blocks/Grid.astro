---
import Lightbox from "../Lightbox.astro";
import Image from "../CloudinaryImage.astro";
import { transform as imageURL } from "../CloudinaryImage.astro";

const { block } = Astro.props;
---

<div
  class:list={[
    "grid",
    "grid-cols-1",
    {
      "1": "sm:grid-cols-1",
      "1/1": "sm:grid-cols-[1fr_1fr]",
      "1/2": "md:grid-cols-[1fr_2fr]",
      "1/3": "md:grid-cols-[1fr_3fr]",
      "2/1": "md:grid-cols-[2fr_1fr]",
      "3/1": "md:grid-cols-[3fr_1fr]",
    }[block.ratio],
    {
      0: "gap-0",
      4: "gap-4",
      8: "gap-8",
      12: "gap-12",
      16: "gap-16",
      20: "gap-20",
    }[block.gap ?? 4],
    "my-4"
  ]}
>
  {
    block.columns?.map((column) => (
      <div
        class="flex flex-col gap-4"
        class:list={[
          {
            0: "md:gap-0",
            4: "md:gap-4",
            8: "md:gap-8",
            12: "md:gap-12",
            16: "md:gap-16",
            20: "md:gap-20",
          }[block.gap ?? 4],
          `justify-${block.align ?? "center"}`,
        ]}
      >
        {column.images.map((url) => (
          <Lightbox src={imageURL(url)} class:list={[
            block.align === "stretch" ? "h-full" : "h-auto",
          ]}>
            <Image
              src={url}
              params="c_limit,w_2560,f_webp"
              class="w-full h-auto"
              class:list={[
                block.align === "stretch"
                  ? "h-full object-cover"
                  : "h-auto object-contain",
              ]}
            />
          </Lightbox>
        ))}
      </div>
    ))
  }
</div>
